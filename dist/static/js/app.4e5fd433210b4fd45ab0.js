webpackJsonp([1],{100:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"hello",data:function(){return{msg:"Welcome to Your Vue.js App"}}}},101:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=n(50),r=n.n(s),a=n(49),o=n.n(a),i=n(257),c=n.n(i),u=n(87),l=n(245),d=n.n(l);e.default={components:{TaskItem:c.a},data:function(){return{url:"",counter:0,taskList:[]}},computed:n.i(u.a)({sid:function(t){return t.syno.sid},sortTaskList:function(t){return d()(t.syno.taskList,["status"],["asc"])}}),mounted:function(){function t(){return e.apply(this,arguments)}var e=o()(r.a.mark(function t(){var e=this;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.$store.state.syno.isInitDS||this.$store.dispatch("initDS"),this.$store.state.syno.sid||console.log("没有sid"),this.$store.state.syno.synoKey||this.$store.dispatch("login"),t.next=5,this.$store.dispatch("getTasks");case 5:setInterval(function(){e.$store.dispatch("getTasks")},2e4);case 6:case"end":return t.stop()}},t,this)}));return t}(),methods:{downloadUrl:function(){function t(t){return e.apply(this,arguments)}var e=o()(r.a.mark(function t(e){return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.url&&!(this.url.length<6)){t.next=2;break}return t.abrupt("return",alert("应该不是正确的下载地址"));case 2:return t.next=4,this.$store.dispatch("downloadUrl",this.url);case 4:case"end":return t.stop()}},t,this)}));return t}(),handleDragleave:function(t){t.preventDefault()},handleDragover:function(t){t.preventDefault()},handleDrop:function(){function t(t){return e.apply(this,arguments)}var e=o()(r.a.mark(function t(e){var n,s,a;return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.preventDefault(),n=e.dataTransfer.files[0],s="macosx/download",a=new FormData,a.append("destination",s),a.append("file",n),a.append("_sid",this.sid),a.append("synoKey",this.$store.state.syno.synoKey),this.$store.dispatch("downloadTorrent",a);case 9:case"end":return t.stop()}},t,this)}));return t}()}}},102:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={props:["itemData"],data:function(){return{}},methods:{niceBytes:function(t){for(var e=["bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],n=parseInt(t,10)||0,s=0;n>=1024;)n/=1024,s++;return n.toFixed(n>=10||s<1?0:1)+" "+e[s]}},computed:{taskProgress:function(){return function(t){var e=0,n=0,s={finished:100,seeding:100},r=s[t.status];if(r)return r;var a=t.additional.file;for(var o in a){var i=a[o];i&&(e+=i.size,n+=i.size_downloaded)}return~~(100*n/e)}(this.itemData)},status:function(){return{finished:"el-icon-circle-check",downloading:"el-icon-loading",waiting:"el-icon-information"}[this.itemData.status]}}}},103:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"header",components:{},data:function(){return{}}}},104:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={data:function(){return{loginForm:{account:"",passwd:"",synoKey:""}}},methods:{submit:function(t){var e=this;this.$refs[t].validate(function(t){t?(e.$store.dispatch("setsynoKey",e.loginForm.synoKey),console.log("验证通过",e.loginForm),e.$store.state.syno.isInitDS||e.$store.dispatch("initDS"),e.$store.dispatch("login",e.loginForm)):console.log("error submit")})}}}},144:function(t,e){},145:function(t,e){},146:function(t,e){},147:function(t,e){},148:function(t,e){},149:function(t,e){},254:function(t,e,n){var s=n(6)(n(99),n(266),null,null,null);t.exports=s.exports},255:function(t,e,n){function s(t){n(145)}var r=n(6)(n(100),n(261),s,"data-v-2b5a585a",null);t.exports=r.exports},256:function(t,e,n){function s(t){n(146)}var r=n(6)(n(101),n(262),s,"data-v-33a56db5",null);t.exports=r.exports},257:function(t,e,n){function s(t){n(148)}var r=n(6)(n(102),n(264),s,"data-v-3b5b1927",null);t.exports=r.exports},258:function(t,e,n){function s(t){n(147)}var r=n(6)(n(103),n(263),s,"data-v-38243d97",null);t.exports=r.exports},259:function(t,e,n){function s(t){n(144)}var r=n(6)(n(104),n(260),s,"data-v-19e8f76a",null);t.exports=r.exports},260:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"login-wrapper"},[n("div",{staticClass:"login-bg"}),t._v(" "),n("div",{staticClass:"dialog-wrapper"},[n("div",{staticClass:"msg-wrapper"},[t._v("使用家里的群晖账号密码登录")]),t._v(" "),n("div",{staticClass:"login-input-wrapper"},[n("el-form",{ref:"loginForm",attrs:{model:t.loginForm}},[n("el-form-item",{attrs:{prop:"account",rules:[{required:!0,message:"不能为空"}]}},[n("el-input",{staticClass:"login-input",attrs:{placeholder:"用户名"},model:{value:t.loginForm.account,callback:function(e){t.loginForm.account=e},expression:"loginForm.account"}})],1),t._v(" "),n("el-form-item",{attrs:{prop:"passwd",rules:[{required:!0,message:"不能为空"}]}},[n("el-input",{staticClass:"login-input",attrs:{type:"password",placeholder:"密码",required:""},model:{value:t.loginForm.passwd,callback:function(e){t.loginForm.passwd=e},expression:"loginForm.passwd"}})],1),t._v(" "),n("el-form-item",{attrs:{prop:"synoKey",rules:[{required:!0,message:"不能为空"}]}},[n("el-input",{staticClass:"login-input",attrs:{placeholder:"在local端配置的Key",required:""},model:{value:t.loginForm.synoKey,callback:function(e){t.loginForm.synoKey=e},expression:"loginForm.synoKey"}})],1),t._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"info"},on:{click:function(e){t.submit("loginForm")}}},[t._v("Login")])],1)],1)],1)])])},staticRenderFns:[]}},261:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"hello"},[n("h1",[t._v(t._s(t.msg))]),t._v(" "),n("h2",[t._v("Essential Links")]),t._v(" "),t._m(0),t._v(" "),n("h2",[t._v("Ecosystem")]),t._v(" "),t._m(1)])},staticRenderFns:[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ul",[n("li",[n("a",{attrs:{href:"https://vuejs.org",target:"_blank"}},[t._v("Core Docs")])]),t._v(" "),n("li",[n("a",{attrs:{href:"https://forum.vuejs.org",target:"_blank"}},[t._v("Forum")])]),t._v(" "),n("li",[n("a",{attrs:{href:"https://gitter.im/vuejs/vue",target:"_blank"}},[t._v("Gitter Chat")])]),t._v(" "),n("li",[n("a",{attrs:{href:"https://twitter.com/vuejs",target:"_blank"}},[t._v("Twitter")])]),t._v(" "),n("br"),t._v(" "),n("li",[n("a",{attrs:{href:"http://vuejs-templates.github.io/webpack/",target:"_blank"}},[t._v("Docs for This Template")])])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ul",[n("li",[n("a",{attrs:{href:"http://router.vuejs.org/",target:"_blank"}},[t._v("vue-router")])]),t._v(" "),n("li",[n("a",{attrs:{href:"http://vuex.vuejs.org/",target:"_blank"}},[t._v("vuex")])]),t._v(" "),n("li",[n("a",{attrs:{href:"http://vue-loader.vuejs.org/",target:"_blank"}},[t._v("vue-loader")])]),t._v(" "),n("li",[n("a",{attrs:{href:"https://github.com/vuejs/awesome-vue",target:"_blank"}},[t._v("awesome-vue")])])])}]}},262:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"download-wrapper",on:{drop:t.handleDrop,dragover:t.handleDragover,dragleave:t.handleDragleave}},[n("el-input",{staticClass:"download-url",attrs:{placeholder:"请输入下载链接"},model:{value:t.url,callback:function(e){t.url=e},expression:"url"}},[n("el-button",{attrs:{icon:"upload"},on:{click:t.downloadUrl},slot:"append"})],1),t._v(" "),t._l(t.sortTaskList,function(t){return n("el-row",[n("el-col",{attrs:{span:24}},[n("TaskItem",{attrs:{"item-data":t}})],1)],1)})],2)},staticRenderFns:[]}},263:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"header"},[n("el-menu",{staticClass:"el-menu-wrapper",attrs:{theme:"dark","default-active":t.activeIndex,mode:"horizontal"},on:{select:t.handleSelect}},[n("div",{staticClass:"logo item"},[n("i",{staticClass:"el-icon-menu logo"})]),t._v(" "),n("el-menu-item",{staticClass:"item",attrs:{index:"1"}},[n("router-link",{attrs:{to:"/"}},[t._v("仪表盘")])],1),t._v(" "),n("el-menu-item",{staticClass:"item",attrs:{index:"1"}},[n("router-link",{attrs:{to:"/download"}},[t._v("下载管理")])],1)],1)],1)},staticRenderFns:[]}},264:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"grid-content tast-item-wrapper"},[n("div",{staticClass:"task-progress light-black",style:{width:t.taskProgress+"%"}}),t._v(" "),n("div",{staticClass:"task-detail-wrapper"},[n("div",{staticClass:"title"},[t._v(t._s(t.itemData.title))]),t._v(" "),n("div",{staticClass:"detail"},[t._v("size: "+t._s(t.niceBytes(t.itemData.size)))]),t._v(" "),n("div",{staticClass:"status-icon el-icon-circle-check",class:t.status})])])},staticRenderFns:[]}},265:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("comheader"),t._v(" "),n("router-view")],1)},staticRenderFns:[]}},266:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n(t.sid?"DownloadList":"Login")},staticRenderFns:[]}},34:function(t,e){},48:function(t,e){t.exports=axios},89:function(t,e,n){"use strict";var s=n(17),r=n(267),a=n(255),o=n.n(a),i=n(254),c=n.n(i);s.default.use(r.a),e.a=new r.a({routes:[{path:"/",name:"Hello",component:o.a},{path:"/download",name:"Download",component:c.a}]})},90:function(t,e,n){"use strict";var s=n(17),r=n(94),a=n(96);s.default.use(r.a);var o=new r.a.Store({modules:{syno:a}});e.a=o},93:function(t,e,n){function s(t){n(149)}var r=n(6)(n(98),n(265),s,null,null);t.exports=r.exports},95:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=n(34),r=(n.n(s),n(91)),a=n.n(r),o=n(92),i=(n.n(o),n(17)),c=n(93),u=n.n(c),l=n(89),d=n(90);i.default.use(a.a),i.default.config.productionTip=!1,new i.default({el:"#app",router:l.a,store:d.a,template:"<App/>",components:{App:u.a}})},96:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"state",function(){return m}),n.d(e,"mutations",function(){return h}),n.d(e,"actions",function(){return _}),n.d(e,"getters",function(){return g});var s,r=n(50),a=n.n(r),o=n(49),i=n.n(o),c=n(107),u=n.n(c),l=n(97),d=n(253),p=(n.n(d),n(48)),f=n.n(p),v={isInitDS:!1,sid:"",synoKey:"",taskList:[],dsOption:{protocol:"http",address:"localhost",port:"5001",debug:!1,success:!1,message:""}},m=v,h=(s={},u()(s,l.a.SET_SID,function(t,e){console.log("mutations sid",e),t.sid=e,t.dsOption.token=e}),u()(s,l.a.REMOVE_SID,function(t){t.sid=""}),u()(s,l.a.SET_SYNOKEY,function(t,e){t.synoKey=e}),u()(s,l.a.SET_DSAPI,function(t,e){t.ds=e,t.isInitDS=!0}),u()(s,l.a.SET_TASKLIST,function(t,e){t.taskList=e}),u()(s,l.a.CLEAN_DSSTATE,function(t){v}),s),_={initDS:function(t){var e=t.commit,n=t.state,s=new d.DownloadStation(n.dsOption);e(l.a.SET_DSAPI,s),n.ds.setRequestOption({params:{synoKey:n.synoKey}})},login:function(t,e){var n=this,s=(t.commit,t.state),r=t.dispatch;return i()(a.a.mark(function t(){var o;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(s.ds){t.next=3;break}return console.error("未初始化"),t.abrupt("return");case 3:return t.next=5,s.ds.login(e);case 5:o=t.sent,o.data.sid?r("setSid",o.data.sid):console.error("登陆失败",o);case 7:case"end":return t.stop()}},t,n)}))()},getTasks:function(t){var e=this,n=t.commit,s=t.state,r=t.dispatch;return i()(a.a.mark(function t(){var o;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.ds.getTasks();case 2:if(o=t.sent,!0!==o.success){t.next=6;break}return n(l.a.SET_TASKLIST,o.data.tasks),t.abrupt("return");case 6:105===o.error.code&&r("logout");case 7:case"end":return t.stop()}},t,e)}))()},cleanDSState:function(t){(0,t.commit)(l.a.CLEAN_DSSTATE)},logout:function(t){var e=t.dispatch;window.localStorage.removeItem("sid"),e("cleanDSState")},setSid:function(t,e){var n=t.commit;window.localStorage.setItem("sid",e),n(l.a.SET_SID,e)},setsynoKey:function(t,e){var n=t.commit;window.localStorage.setItem("synoKey",e),n(l.a.SET_SYNOKEY,e)},downloadUrl:function(t,e){var n=this;t.commit;return i()(a.a.mark(function t(){var s;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,m.ds.createTask({uri:e});case 2:if(s=t.sent,!s.data.success){t.next=6;break}return n.url="",t.abrupt("return",alert("添加下载成功"));case 6:alert("下载失败",s.error.code);case 7:case"end":return t.stop()}},t,n)}))()},downloadTorrent:function(t,e){var n=this;t.commit,t.dispatch;return i()(a.a.mark(function t(){var s;return a.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,f()({url:"http://localhost:5001/creatTorrent",data:e,method:"post"});case 2:s=t.sent,s.success&&alert("创建种子下载成功");case 4:case"end":return t.stop()}},t,n)}))()}},g={}},97:function(t,e,n){"use strict";e.a={SET_SID:"SET_SID",SET_SYNOKEY:"SET_SOCKETNAME",SET_DSAPI:"SET_DSAPI",SET_TASKLIST:"SET_TASKLIST",REMOVE_SID:"REMOVE_SID",CLEAN_DSSTATE:"CLEAN_DSSTATE"}},98:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=n(258),r=n.n(s);e.default={name:"app",components:{comheader:r.a}}},99:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=n(259),r=n.n(s),a=n(256),o=n.n(a),i=n(87);e.default={components:{Login:r.a,DownloadList:o.a},computed:n.i(i.a)({sid:function(t){return t.syno.sid},synoKey:function(t){return t.syno.synoKey}}),mounted:function(){var t=window.localStorage.getItem("sid"),e=window.localStorage.getItem("synoKey");if(t&&!this.sid&&this.$store.dispatch("setSid",t),e&&!this.synoKey&&this.$store.dispatch("setsynoKey",e),!e||!t)return this.$store.dispatch("cleanDSState")}}}},[95]);
//# sourceMappingURL=app.4e5fd433210b4fd45ab0.js.map